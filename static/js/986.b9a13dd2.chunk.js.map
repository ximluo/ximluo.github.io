{"version":3,"file":"static/js/986.b9a13dd2.chunk.js","mappings":"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","sources":["components/ui/OptimizedImage.tsx"],"sourcesContent":["import React, { useMemo } from \"react\"\nimport manifest from \"../../generated/imageManifest.json\"\n\ninterface ImageVariant {\n  src: string\n  w: number\n  type: string\n}\n\ninterface ManifestEntry {\n  width: number | null\n  height: number | null\n  variants: ImageVariant[]\n  poster?: {\n    src: string\n    w: number\n    type: string\n  } | null\n  animated?: {\n    src: string\n    w: number\n    type: string\n  } | null\n  animatedDetail?: {\n    src: string\n    w: number\n    type: string\n  } | null\n}\n\ninterface ImageManifest {\n  generatedAt: string\n  widths: number[]\n  images: Record<string, ManifestEntry>\n}\n\ninterface OptimizedImageProps\n  extends Omit<React.ImgHTMLAttributes<HTMLImageElement>, \"src\" | \"alt\" | \"loading\"> {\n  src: string\n  alt: string\n  priority?: boolean\n  preferPosterForGif?: boolean\n  preferAnimatedGifVariant?: boolean\n  animatedGifVariantTier?: \"thumb\" | \"detail\"\n}\n\nconst imageManifest = manifest as ImageManifest\n\nfunction normalizeSourcePath(source: string): string {\n  const base = source.split(\"#\")[0].split(\"?\")[0]\n\n  if (base.startsWith(\"http://\") || base.startsWith(\"https://\")) {\n    try {\n      const url = new URL(base)\n      return url.pathname || base\n    } catch {\n      return base\n    }\n  }\n\n  const publicPrefix = process.env.PUBLIC_URL || \"\"\n  if (publicPrefix && base.startsWith(publicPrefix)) {\n    const stripped = base.slice(publicPrefix.length)\n    return stripped.startsWith(\"/\") ? stripped : `/${stripped}`\n  }\n\n  return base.startsWith(\"/\") ? base : `/${base}`\n}\n\nconst OptimizedImage: React.FC<OptimizedImageProps> = ({\n  src,\n  alt,\n  priority = false,\n  preferPosterForGif = false,\n  preferAnimatedGifVariant = false,\n  animatedGifVariantTier = \"thumb\",\n  sizes,\n  width,\n  height,\n  decoding,\n  fetchPriority,\n  ...imgProps\n}) => {\n  const normalizedSource = normalizeSourcePath(src)\n  const isGifSource = normalizedSource.toLowerCase().endsWith(\".gif\")\n\n  const optimized = useMemo(() => {\n    const entry = imageManifest.images[normalizedSource]\n    if (!entry) return null\n    const webpVariants = entry.variants\n      .filter((variant) => variant.type === \"image/webp\")\n      .sort((a, b) => a.w - b.w)\n    return {\n      entry,\n      srcSet: webpVariants.length\n        ? webpVariants.map((variant) => `${variant.src} ${variant.w}w`).join(\", \")\n        : undefined,\n    }\n  }, [normalizedSource])\n\n  const shouldUsePoster = Boolean(preferPosterForGif && isGifSource && optimized?.entry.poster?.src)\n  const preferredAnimatedGifVariant =\n    animatedGifVariantTier === \"detail\" ? optimized?.entry.animatedDetail ?? optimized?.entry.animated : optimized?.entry.animated\n  const shouldUseAnimatedGifVariant = Boolean(\n    !shouldUsePoster && preferAnimatedGifVariant && isGifSource && preferredAnimatedGifVariant?.src,\n  )\n  const resolvedSrc = shouldUsePoster\n    ? optimized?.entry.poster?.src ?? src\n    : shouldUseAnimatedGifVariant\n      ? preferredAnimatedGifVariant?.src ?? src\n      : src\n  const resolvedSrcSet = shouldUsePoster ? undefined : optimized?.srcSet\n  const resolvedSizes = shouldUsePoster ? undefined : sizes ?? (resolvedSrcSet ? \"100vw\" : undefined)\n\n  return (\n    <img\n      {...imgProps}\n      src={resolvedSrc}\n      alt={alt}\n      srcSet={resolvedSrcSet}\n      sizes={resolvedSizes}\n      width={width ?? (optimized?.entry.width ?? undefined)}\n      height={height ?? (optimized?.entry.height ?? undefined)}\n      loading={priority ? \"eager\" : \"lazy\"}\n      decoding={decoding ?? \"async\"}\n      fetchPriority={fetchPriority ?? (priority ? \"high\" : \"auto\")}\n    />\n  )\n}\n\nexport default OptimizedImage\n"],"names":["imageManifest","manifest","_ref","_optimized$entry$post","_optimized$entry$anim","_optimized$entry$post2","_optimized$entry$post3","_preferredAnimatedGif","_optimized$entry$widt","_optimized$entry$heig","src","alt","priority","preferPosterForGif","preferAnimatedGifVariant","animatedGifVariantTier","sizes","width","height","decoding","fetchPriority","imgProps","normalizedSource","source","base","split","startsWith","URL","pathname","normalizeSourcePath","isGifSource","toLowerCase","endsWith","optimized","useMemo","entry","images","webpVariants","variants","filter","variant","type","sort","a","b","w","srcSet","length","map","join","undefined","shouldUsePoster","Boolean","poster","preferredAnimatedGifVariant","animatedDetail","animated","shouldUseAnimatedGifVariant","resolvedSrc","resolvedSrcSet","resolvedSizes","_jsx","loading"],"sourceRoot":""}