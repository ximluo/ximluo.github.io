{"version":3,"file":"static/js/986.3be10774.chunk.js","mappings":"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","sources":["components/ui/OptimizedImage.tsx"],"sourcesContent":["import React, { useMemo } from \"react\"\nimport manifest from \"../../generated/imageManifest.json\"\n\ninterface ImageVariant {\n  src: string\n  w: number\n  type: string\n}\n\ninterface ManifestEntry {\n  width: number | null\n  height: number | null\n  variants: ImageVariant[]\n  poster?: {\n    src: string\n    w: number\n    type: string\n  } | null\n}\n\ninterface ImageManifest {\n  generatedAt: string\n  widths: number[]\n  images: Record<string, ManifestEntry>\n}\n\ninterface OptimizedImageProps\n  extends Omit<React.ImgHTMLAttributes<HTMLImageElement>, \"src\" | \"alt\" | \"loading\"> {\n  src: string\n  alt: string\n  priority?: boolean\n  preferPosterForGif?: boolean\n}\n\nconst imageManifest = manifest as ImageManifest\n\nfunction normalizeSourcePath(source: string): string {\n  const base = source.split(\"#\")[0].split(\"?\")[0]\n\n  if (base.startsWith(\"http://\") || base.startsWith(\"https://\")) {\n    try {\n      const url = new URL(base)\n      return url.pathname || base\n    } catch {\n      return base\n    }\n  }\n\n  const publicPrefix = process.env.PUBLIC_URL || \"\"\n  if (publicPrefix && base.startsWith(publicPrefix)) {\n    const stripped = base.slice(publicPrefix.length)\n    return stripped.startsWith(\"/\") ? stripped : `/${stripped}`\n  }\n\n  return base.startsWith(\"/\") ? base : `/${base}`\n}\n\nconst OptimizedImage: React.FC<OptimizedImageProps> = ({\n  src,\n  alt,\n  priority = false,\n  preferPosterForGif = false,\n  sizes,\n  width,\n  height,\n  decoding,\n  fetchPriority,\n  ...imgProps\n}) => {\n  const normalizedSource = normalizeSourcePath(src)\n  const isGifSource = normalizedSource.toLowerCase().endsWith(\".gif\")\n\n  const optimized = useMemo(() => {\n    const entry = imageManifest.images[normalizedSource]\n    if (!entry) return null\n    const avifVariants = entry.variants\n      .filter((variant) => variant.type === \"image/avif\")\n      .sort((a, b) => a.w - b.w)\n    const webpVariants = entry.variants\n      .filter((variant) => variant.type === \"image/webp\")\n      .sort((a, b) => a.w - b.w)\n    return {\n      entry,\n      avifSrcSet: avifVariants.length\n        ? avifVariants.map((variant) => `${variant.src} ${variant.w}w`).join(\", \")\n        : undefined,\n      webpSrcSet: webpVariants.length\n        ? webpVariants.map((variant) => `${variant.src} ${variant.w}w`).join(\", \")\n        : undefined,\n      fallbackSrc: webpVariants[webpVariants.length - 1]?.src ?? src,\n    }\n  }, [normalizedSource, src])\n\n  const shouldUsePoster = Boolean(preferPosterForGif && isGifSource && optimized?.entry.poster?.src)\n  const resolvedSrc = shouldUsePoster ? optimized?.entry.poster?.src ?? src : src\n  const resolvedSizes =\n    shouldUsePoster\n      ? undefined\n      : sizes ?? ((optimized?.webpSrcSet || optimized?.avifSrcSet) ? \"100vw\" : undefined)\n\n  if (!optimized || shouldUsePoster) {\n    return (\n      <img\n        {...imgProps}\n        src={resolvedSrc}\n        alt={alt}\n        width={width ?? (optimized?.entry.width ?? undefined)}\n        height={height ?? (optimized?.entry.height ?? undefined)}\n        loading={priority ? \"eager\" : \"lazy\"}\n        decoding={decoding ?? \"async\"}\n        fetchPriority={fetchPriority ?? (priority ? \"high\" : \"auto\")}\n      />\n    )\n  }\n\n  return (\n    <picture>\n      {optimized.avifSrcSet && (\n        <source type=\"image/avif\" srcSet={optimized.avifSrcSet} sizes={resolvedSizes} />\n      )}\n      {optimized.webpSrcSet && (\n        <source type=\"image/webp\" srcSet={optimized.webpSrcSet} sizes={resolvedSizes} />\n      )}\n      <img\n        {...imgProps}\n        src={optimized.fallbackSrc}\n        alt={alt}\n        width={width ?? (optimized.entry.width ?? undefined)}\n        height={height ?? (optimized.entry.height ?? undefined)}\n        loading={priority ? \"eager\" : \"lazy\"}\n        decoding={decoding ?? \"async\"}\n        fetchPriority={fetchPriority ?? (priority ? \"high\" : \"auto\")}\n      />\n    </picture>\n  )\n}\n\nexport default OptimizedImage\n"],"names":["imageManifest","manifest","_ref","_optimized$entry$post","_optimized$entry$post2","_optimized$entry$post3","_optimized$entry$widt2","_optimized$entry$heig2","src","alt","priority","preferPosterForGif","sizes","width","height","decoding","fetchPriority","imgProps","normalizedSource","source","base","split","startsWith","URL","pathname","normalizeSourcePath","isGifSource","toLowerCase","endsWith","optimized","useMemo","_webpVariants$src","_webpVariants","entry","images","avifVariants","variants","filter","variant","type","sort","a","b","w","webpVariants","avifSrcSet","length","map","join","undefined","webpSrcSet","fallbackSrc","shouldUsePoster","Boolean","poster","resolvedSrc","resolvedSizes","_optimized$entry$widt","_optimized$entry$heig","_jsx","loading","_jsxs","children","srcSet"],"sourceRoot":""}