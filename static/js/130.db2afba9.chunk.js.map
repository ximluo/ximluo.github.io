{"version":3,"file":"static/js/130.db2afba9.chunk.js","mappings":"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","sources":["features/bunny/bunnySceneMaterials.ts","features/bunny/useBunnyPointerInput.ts","features/bunny/useBunnyRuntimeLoop.ts","features/bunny/bunnySceneSetup.helpers.ts","features/bunny/useBunnySceneSetup.ts","features/bunny/BunnyScene.tsx","features/bunny/useCarrotStorage.ts","features/bunny/BunnyModal.tsx"],"sourcesContent":["import * as THREE from \"three\"\n\nexport const createOutlineMaterial = () =>\n  new THREE.ShaderMaterial({\n    uniforms: {\n      color: { value: new THREE.Color(0x000000) },\n      size: { value: 0.02 },\n      time: { value: 0.0 },\n    },\n    vertexShader: `\n      uniform float size;\n      uniform float time;\n\n      void main() {\n        vec3 transformed = position + normal * size * (1.0 + abs(sin(position.y * time * 0.02) * 2.0));\n        vec4 modelViewPosition = modelViewMatrix * vec4(transformed, 1.0);\n        gl_Position = projectionMatrix * modelViewPosition; \n      }\n    `,\n    fragmentShader: `\n      uniform vec3 color;\n      void main() {\n        gl_FragColor = vec4(color, 1.0);\n      }\n    `,\n    side: THREE.BackSide,\n  })\n\nexport const createFloorSimulationMaterial = () =>\n  new THREE.ShaderMaterial({\n    uniforms: {\n      inputTexture: { value: null },\n      time: { value: 0.0 },\n      blade1PosOld: { value: new THREE.Vector2(0.5, 0.5) },\n      blade1PosNew: { value: new THREE.Vector2(0.5, 0.5) },\n      strength: { value: 0.0 },\n    },\n    vertexShader: `\n      precision highp float;\n      uniform float time;\n      varying vec2 vUv;\n      void main() {\n        vUv = uv;\n        vec4 modelViewPosition = modelViewMatrix * vec4(position, 1.0);\n        gl_Position = projectionMatrix * modelViewPosition; \n      }\n    `,\n    fragmentShader: `\n      precision highp float;\n      uniform sampler2D inputTexture;\n      uniform vec2 blade1PosOld;\n      uniform vec2 blade1PosNew;\n      uniform float strength;\n      uniform float time;\n      varying vec2 vUv;\n\n      float lineSegment(vec2 p, vec2 a, vec2 b, float thickness) {\n          vec2 pa = p - a;\n          vec2 ba = b - a;\n          float h = clamp(dot(pa,ba)/dot(ba,ba), 0.0, 1.0);\n          float idk = length(pa - ba*h);\n          return smoothstep(thickness, 0.2 * thickness, idk);\n      }\n\n      void main(void) {\n        vec4 prevTexture = texture2D(inputTexture, vUv);\n        vec3 col = prevTexture.rgb * 0.999;\n        if (strength > 0.0) {\n            float space = 0.001;\n            float crease = 0.001;\n            float thickness = 0.001 + strength * 0.001;\n            float leftRed = lineSegment(vUv + space, blade1PosOld, blade1PosNew, thickness);\n            float leftGreen = lineSegment(vUv + space + crease, blade1PosOld, blade1PosNew, thickness);\n            float rightRed = lineSegment(vUv - space - crease, blade1PosOld, blade1PosNew, thickness);\n            float rightGreen = lineSegment(vUv - space, blade1PosOld, blade1PosNew, thickness);\n            col.r += (leftRed + rightRed) * strength * 3.0;\n            col.g += (leftGreen + rightGreen) * strength * 3.0;\n            col.r = clamp(col.r, 0.0, 1.0);\n            col.g = clamp(col.g, 0.0, 1.0);\n        }\n        gl_FragColor = vec4(col, 1.0);\n      }\n    `,\n  })\n\nexport class BufferSim {\n  renderer: THREE.WebGLRenderer\n  shader: THREE.ShaderMaterial\n  orthoScene: THREE.Scene\n  fbos: THREE.WebGLRenderTarget[]\n  current: number\n  output: THREE.WebGLRenderTarget\n  orthoCamera: THREE.OrthographicCamera\n  orthoQuad: THREE.Mesh\n\n  constructor(\n    renderer: THREE.WebGLRenderer,\n    width: number,\n    height: number,\n    shader: THREE.ShaderMaterial,\n  ) {\n    this.renderer = renderer\n    this.shader = shader\n    this.orthoScene = new THREE.Scene()\n\n    const fbo = new THREE.WebGLRenderTarget(width, height, {\n      wrapS: THREE.ClampToEdgeWrapping,\n      wrapT: THREE.ClampToEdgeWrapping,\n      minFilter: THREE.LinearFilter,\n      magFilter: THREE.LinearFilter,\n      format: THREE.RGBAFormat,\n      type: THREE.FloatType,\n      stencilBuffer: false,\n      depthBuffer: false,\n    })\n\n    fbo.texture.generateMipmaps = false\n\n    this.fbos = [fbo, fbo.clone()]\n    this.current = 0\n    this.output = this.fbos[0]\n    this.orthoCamera = new THREE.OrthographicCamera(\n      width / -2,\n      width / 2,\n      height / 2,\n      height / -2,\n      0.00001,\n      1000,\n    )\n    this.orthoQuad = new THREE.Mesh(new THREE.PlaneGeometry(width, height), this.shader)\n    this.orthoScene.add(this.orthoQuad)\n  }\n\n  render() {\n    this.shader.uniforms.inputTexture.value = this.fbos[this.current].texture\n    this.current = 1 - this.current\n    this.output = this.fbos[this.current]\n    this.renderer.setRenderTarget(this.output)\n    this.renderer.render(this.orthoScene, this.orthoCamera)\n    this.renderer.setRenderTarget(null)\n  }\n\n  dispose() {\n    this.orthoQuad.geometry.dispose()\n    this.fbos.forEach((fbo) => fbo.dispose())\n  }\n}\n","import { useEffect, type MutableRefObject } from \"react\"\nimport * as THREE from \"three\"\n\ninterface BunnyPointerInputOptions {\n  mouseRef: MutableRefObject<THREE.Vector2>\n  rabbitRef: MutableRefObject<THREE.Group | null>\n  isJumping: boolean\n  onJump: () => void\n}\n\nexport const useBunnyPointerInput = ({\n  mouseRef,\n  rabbitRef,\n  isJumping,\n  onJump,\n}: BunnyPointerInputOptions) => {\n  useEffect(() => {\n    const handleMouseMove = (event: MouseEvent) => {\n      mouseRef.current.x = (event.clientX / window.innerWidth) * 2 - 1\n      mouseRef.current.y = -(event.clientY / window.innerHeight) * 2 + 1\n    }\n\n    const handleTouchMove = (event: TouchEvent) => {\n      if (event.touches.length !== 1) return\n      event.preventDefault()\n      mouseRef.current.x = (event.touches[0].clientX / window.innerWidth) * 2 - 1\n      mouseRef.current.y = -(event.touches[0].clientY / window.innerHeight) * 2 + 1\n    }\n\n    const handlePress = () => {\n      if (rabbitRef.current && !isJumping) {\n        onJump()\n      }\n    }\n\n    window.addEventListener(\"mousemove\", handleMouseMove)\n    window.addEventListener(\"touchmove\", handleTouchMove, { passive: false })\n    window.addEventListener(\"mousedown\", handlePress)\n    window.addEventListener(\"touchstart\", handlePress)\n\n    return () => {\n      window.removeEventListener(\"mousemove\", handleMouseMove)\n      window.removeEventListener(\"touchmove\", handleTouchMove)\n      window.removeEventListener(\"mousedown\", handlePress)\n      window.removeEventListener(\"touchstart\", handlePress)\n    }\n  }, [isJumping, mouseRef, onJump, rabbitRef])\n}\n","import { useFrame } from \"@react-three/fiber\"\nimport type { MutableRefObject } from \"react\"\nimport * as THREE from \"three\"\nimport { Reflector } from \"three/examples/jsm/objects/Reflector.js\"\nimport { BufferSim } from \"./bunnySceneMaterials\"\n\nconst getShortestAngle = (v: number) => {\n  let a = v % (Math.PI * 2)\n  if (a < -Math.PI) a += Math.PI * 2\n  else if (a > Math.PI) a -= Math.PI * 2\n  return a\n}\n\nconst constrain = (v: number, vMin: number, vMax: number) => Math.min(vMax, Math.max(vMin, v))\n\ninterface BunnyRuntimeLoopOptions {\n  modelLoaded: boolean\n  isMobile: boolean\n  isJumping: boolean\n  camera: THREE.Camera\n  timeRef: MutableRefObject<number>\n  outlineMatRef: MutableRefObject<THREE.ShaderMaterial>\n  rabbitRef: MutableRefObject<THREE.Group | null>\n  earLeftRef: MutableRefObject<THREE.Object3D | null>\n  earRightRef: MutableRefObject<THREE.Object3D | null>\n  carrotRef: MutableRefObject<THREE.Object3D | null>\n  floorRef: MutableRefObject<Reflector | null>\n  lineRef: MutableRefObject<THREE.Line | null>\n  floorSimMatRef: MutableRefObject<THREE.ShaderMaterial | null>\n  bufferSimRef: MutableRefObject<BufferSim | null>\n  floorSizeRef: MutableRefObject<number>\n  mouseRef: MutableRefObject<THREE.Vector2>\n  raycasterRef: MutableRefObject<THREE.Raycaster>\n  heroSpeedRef: MutableRefObject<THREE.Vector2>\n  heroOldRotRef: MutableRefObject<number>\n  heroAngularSpeedRef: MutableRefObject<number>\n  heroOldUVPosRef: MutableRefObject<THREE.Vector2>\n  heroNewUVPosRef: MutableRefObject<THREE.Vector2>\n  targetHeroUVPosRef: MutableRefObject<THREE.Vector2>\n  targetHeroAbsPosRef: MutableRefObject<THREE.Vector2>\n  onCollisionCheck: () => void\n}\n\nexport const useBunnyRuntimeLoop = ({\n  modelLoaded,\n  isMobile,\n  isJumping,\n  camera,\n  timeRef,\n  outlineMatRef,\n  rabbitRef,\n  earLeftRef,\n  earRightRef,\n  carrotRef,\n  floorRef,\n  lineRef,\n  floorSimMatRef,\n  bufferSimRef,\n  floorSizeRef,\n  mouseRef,\n  raycasterRef,\n  heroSpeedRef,\n  heroOldRotRef,\n  heroAngularSpeedRef,\n  heroOldUVPosRef,\n  heroNewUVPosRef,\n  targetHeroUVPosRef,\n  targetHeroAbsPosRef,\n  onCollisionCheck,\n}: BunnyRuntimeLoopOptions) => {\n  useFrame((_, delta) => {\n    if (!modelLoaded) return\n\n    const dt = Math.min(delta, 0.3)\n    timeRef.current += dt\n    outlineMatRef.current.uniforms.time.value = timeRef.current\n\n    if (\n      !rabbitRef.current ||\n      !lineRef.current ||\n      !floorRef.current ||\n      !floorSimMatRef.current ||\n      !bufferSimRef.current\n    ) {\n      return\n    }\n\n    raycasterRef.current.setFromCamera(mouseRef.current, camera)\n    const intersects = raycasterRef.current.intersectObject(floorRef.current)\n\n    if (intersects.length > 0 && intersects[0].uv) {\n      targetHeroUVPosRef.current.x = intersects[0].uv.x\n      targetHeroUVPosRef.current.y = intersects[0].uv.y\n    }\n\n    const clampRange = isMobile ? 0.22 : 0.3\n    const constrainUVPosX = constrain(targetHeroUVPosRef.current.x - 0.5, -clampRange, clampRange)\n    const constrainUVPosY = constrain(targetHeroUVPosRef.current.y - 0.5, -clampRange, clampRange)\n    targetHeroAbsPosRef.current.x = constrainUVPosX * floorSizeRef.current\n    targetHeroAbsPosRef.current.y = -constrainUVPosY * floorSizeRef.current\n\n    const dx = targetHeroAbsPosRef.current.x - rabbitRef.current.position.x\n    const dy = targetHeroAbsPosRef.current.y - rabbitRef.current.position.z\n\n    const angle = Math.atan2(dy, dx)\n    const heroDistance = Math.sqrt(dx * dx + dy * dy)\n    const ax = dx * dt * 0.3\n    const ay = dy * dt * 0.3\n\n    heroSpeedRef.current.x += ax\n    heroSpeedRef.current.y += ay\n    heroSpeedRef.current.x *= Math.pow(dt, 0.005)\n    heroSpeedRef.current.y *= Math.pow(dt, 0.005)\n\n    rabbitRef.current.position.x += heroSpeedRef.current.x\n    rabbitRef.current.position.z += heroSpeedRef.current.y\n\n    const targetRot = -angle + Math.PI / 2\n    if (heroDistance > 0.3) {\n      rabbitRef.current.rotation.y +=\n        getShortestAngle(targetRot - rabbitRef.current.rotation.y) * 3 * dt\n    }\n\n    heroAngularSpeedRef.current = getShortestAngle(\n      rabbitRef.current.rotation.y - heroOldRotRef.current,\n    )\n    heroOldRotRef.current = rabbitRef.current.rotation.y\n\n    if (!isJumping && earLeftRef.current && earRightRef.current) {\n      earLeftRef.current.rotation.x = earRightRef.current.rotation.x =\n        -heroSpeedRef.current.length() * 2\n    }\n\n    const linePositions = (lineRef.current.geometry as THREE.BufferGeometry).attributes.position\n      .array\n    linePositions[0] = targetHeroAbsPosRef.current.x\n    linePositions[2] = targetHeroAbsPosRef.current.y\n    linePositions[3] = rabbitRef.current.position.x\n    linePositions[4] = rabbitRef.current.position.y\n    linePositions[5] = rabbitRef.current.position.z\n    ;(lineRef.current.geometry as THREE.BufferGeometry).attributes.position.needsUpdate = true\n    lineRef.current.computeLineDistances()\n\n    heroNewUVPosRef.current.x = 0.5 + rabbitRef.current.position.x / floorSizeRef.current\n    heroNewUVPosRef.current.y = 0.5 - rabbitRef.current.position.z / floorSizeRef.current\n\n    floorSimMatRef.current.uniforms.time.value += dt\n    floorSimMatRef.current.uniforms.blade1PosNew.value = heroNewUVPosRef.current\n    floorSimMatRef.current.uniforms.blade1PosOld.value = heroOldUVPosRef.current\n    floorSimMatRef.current.uniforms.strength.value = isJumping\n      ? 0\n      : 1 / (1 + heroSpeedRef.current.length() * 10)\n\n    bufferSimRef.current.render()\n\n    if (floorRef.current.material instanceof THREE.ShaderMaterial) {\n      floorRef.current.material.uniforms.tScratches = {\n        value: bufferSimRef.current.output.texture,\n      }\n    }\n\n    heroOldUVPosRef.current.copy(heroNewUVPosRef.current)\n\n    if (carrotRef.current) {\n      carrotRef.current.rotation.y += dt\n    }\n\n    onCollisionCheck()\n  })\n}\n","import type { Dispatch, MutableRefObject, SetStateAction } from \"react\"\nimport * as THREE from \"three\"\nimport { GLTFLoader } from \"three/examples/jsm/loaders/GLTFLoader.js\"\nimport { Reflector } from \"three/examples/jsm/objects/Reflector.js\"\nimport { BufferSim, createFloorSimulationMaterial } from \"./bunnySceneMaterials\"\nimport type { BunnySceneColors } from \"./bunnyScene.types\"\n\nconst CARROT_MARKER_Y_OFFSET = 0.01\n\nexport type AddToScene = <T extends THREE.Object3D>(object: T) => T\n\nexport interface BunnyMaterialRefs {\n  primMatRef: MutableRefObject<THREE.MeshToonMaterial>\n  secMatRef: MutableRefObject<THREE.MeshToonMaterial>\n  bonusMatRef: MutableRefObject<THREE.MeshToonMaterial>\n  leafMatRef: MutableRefObject<THREE.MeshToonMaterial>\n  outlineMatRef: MutableRefObject<THREE.ShaderMaterial>\n}\n\nexport interface BunnyScaffoldResources {\n  floorSimMat: THREE.ShaderMaterial\n  lineMaterial: THREE.LineDashedMaterial\n  lineGeometry: THREE.BufferGeometry\n  particleGeom: THREE.BoxGeometry\n}\n\ninterface CreateBunnySceneScaffoldOptions extends BunnyMaterialRefs {\n  gl: THREE.WebGLRenderer\n  colors: BunnySceneColors\n  floorSizeRef: MutableRefObject<number>\n  lineRef: MutableRefObject<THREE.Line | null>\n  floorRef: MutableRefObject<Reflector | null>\n  carrotMarkerRef: MutableRefObject<THREE.Mesh | null>\n  carrotMarkerDotRef: MutableRefObject<THREE.Mesh | null>\n  bufferSimRef: MutableRefObject<BufferSim | null>\n  floorSimMatRef: MutableRefObject<THREE.ShaderMaterial | null>\n  particlesRef: MutableRefObject<THREE.Mesh[]>\n  particles2Ref: MutableRefObject<THREE.Mesh[]>\n  addToScene: AddToScene\n}\n\ninterface RabbitModelParts {\n  rabbit: THREE.Group\n  rabbitBody: THREE.Mesh\n  earRight: THREE.Mesh\n  earLeft: THREE.Mesh\n  tail: THREE.Mesh\n  footLeft: THREE.Mesh\n  footRight: THREE.Mesh\n  eyeLeft: THREE.Mesh\n  eyeRight: THREE.Mesh\n  carrot: THREE.Mesh\n  carrotLeaf: THREE.Mesh\n  carrotLeaf2: THREE.Mesh\n}\n\ninterface LoadRabbitModelIntoSceneOptions extends BunnyMaterialRefs {\n  addToScene: AddToScene\n  disposedRef: MutableRefObject<boolean>\n  setModelLoaded: Dispatch<SetStateAction<boolean>>\n  rabbitRef: MutableRefObject<THREE.Group | null>\n  rabbitBodyRef: MutableRefObject<THREE.Object3D | null>\n  earLeftRef: MutableRefObject<THREE.Object3D | null>\n  earRightRef: MutableRefObject<THREE.Object3D | null>\n  carrotRef: MutableRefObject<THREE.Object3D | null>\n}\n\nconst applyRabbitMaterialsAndOutlines = (\n  parts: RabbitModelParts,\n  { primMatRef, secMatRef, bonusMatRef, leafMatRef, outlineMatRef }: BunnyMaterialRefs,\n) => {\n  parts.carrot.rotation.z = 0.2\n  parts.carrot.rotation.x = 0.2\n\n  parts.rabbitBody.material = primMatRef.current\n  parts.earRight.material = primMatRef.current\n  parts.earLeft.material = primMatRef.current\n  parts.tail.material = primMatRef.current\n  parts.footLeft.material = secMatRef.current\n  parts.footRight.material = secMatRef.current\n  parts.eyeLeft.material = secMatRef.current\n  parts.eyeRight.material = secMatRef.current\n  parts.carrot.material = bonusMatRef.current\n  parts.carrotLeaf.material = leafMatRef.current\n  parts.carrotLeaf2.material = leafMatRef.current\n\n  const addOutline = (obj: THREE.Object3D) => {\n    const outline = obj.clone() as THREE.Mesh\n    outline.children = []\n    outline.position.set(0, 0, 0)\n    outline.rotation.set(0, 0, 0)\n    outline.scale.set(1, 1, 1)\n    outline.material = outlineMatRef.current\n    obj.add(outline)\n  }\n\n  addOutline(parts.rabbitBody)\n  addOutline(parts.earRight)\n  addOutline(parts.earLeft)\n  addOutline(parts.tail)\n  addOutline(parts.carrot)\n\n  parts.rabbit.traverse((object) => {\n    if ((object as THREE.Mesh).isMesh) {\n      object.castShadow = true\n      object.receiveShadow = true\n    }\n  })\n\n  parts.carrot.traverse((object) => {\n    if ((object as THREE.Mesh).isMesh) {\n      object.castShadow = true\n    }\n  })\n}\n\nexport const loadRabbitModelIntoScene = ({\n  addToScene,\n  disposedRef,\n  setModelLoaded,\n  rabbitRef,\n  rabbitBodyRef,\n  earLeftRef,\n  earRightRef,\n  carrotRef,\n  ...materialRefs\n}: LoadRabbitModelIntoSceneOptions) => {\n  const loader = new GLTFLoader()\n\n  loader.load(\"/models/rabbit.glb\", (gltf) => {\n    if (disposedRef.current) return\n\n    const model = gltf.scene\n    const rabbit = model.getObjectByName(\"Rabbit\") as THREE.Group | null\n    const rabbitBody = model.getObjectByName(\"body\") as THREE.Mesh | null\n    const earRight = model.getObjectByName(\"earRight\") as THREE.Mesh | null\n    const earLeft = model.getObjectByName(\"earLeft\") as THREE.Mesh | null\n    const tail = model.getObjectByName(\"tail\") as THREE.Mesh | null\n    const footLeft = model.getObjectByName(\"footLeft\") as THREE.Mesh | null\n    const footRight = model.getObjectByName(\"footRight\") as THREE.Mesh | null\n    const eyeLeft = model.getObjectByName(\"eyeLeft\") as THREE.Mesh | null\n    const eyeRight = model.getObjectByName(\"eyeRight\") as THREE.Mesh | null\n    const carrot = model.getObjectByName(\"carrot\") as THREE.Mesh | null\n    const carrotLeaf = model.getObjectByName(\"carrotLeaf\") as THREE.Mesh | null\n    const carrotLeaf2 = model.getObjectByName(\"carrotLeaf2\") as THREE.Mesh | null\n\n    if (\n      !rabbit ||\n      !rabbitBody ||\n      !earRight ||\n      !earLeft ||\n      !tail ||\n      !footLeft ||\n      !footRight ||\n      !eyeLeft ||\n      !eyeRight ||\n      !carrot ||\n      !carrotLeaf ||\n      !carrotLeaf2\n    ) {\n      return\n    }\n\n    const parts: RabbitModelParts = {\n      rabbit,\n      rabbitBody,\n      earRight,\n      earLeft,\n      tail,\n      footLeft,\n      footRight,\n      eyeLeft,\n      eyeRight,\n      carrot,\n      carrotLeaf,\n      carrotLeaf2,\n    }\n\n    applyRabbitMaterialsAndOutlines(parts, materialRefs)\n\n    addToScene(rabbit)\n    addToScene(carrot)\n\n    rabbitRef.current = rabbit\n    rabbitBodyRef.current = rabbitBody\n    earLeftRef.current = earLeft\n    earRightRef.current = earRight\n    carrotRef.current = carrot\n\n    setModelLoaded(true)\n  })\n}\n\nexport const createBunnySceneScaffold = ({\n  gl,\n  colors,\n  floorSizeRef,\n  lineRef,\n  floorRef,\n  carrotMarkerRef,\n  carrotMarkerDotRef,\n  bufferSimRef,\n  floorSimMatRef,\n  particlesRef,\n  particles2Ref,\n  primMatRef,\n  bonusMatRef,\n  addToScene,\n}: CreateBunnySceneScaffoldOptions): BunnyScaffoldResources => {\n  const floorSimMat = createFloorSimulationMaterial()\n  floorSimMatRef.current = floorSimMat\n  bufferSimRef.current = new BufferSim(gl, 1024, 1024, floorSimMat)\n\n  const lineMaterial = new THREE.LineDashedMaterial({\n    color: 0x7beeff,\n    linewidth: 1,\n    scale: 1,\n    dashSize: 0.2,\n    gapSize: 0.1,\n  })\n\n  const lineGeometry = new THREE.BufferGeometry().setFromPoints([\n    new THREE.Vector3(0, 0.2, 0),\n    new THREE.Vector3(3, 0.2, 3),\n  ])\n  const line = addToScene(new THREE.Line(lineGeometry, lineMaterial))\n  lineRef.current = line\n\n  const particleGeom = new THREE.BoxGeometry(0.2, 0.2, 0.2, 1, 1, 1)\n  const particles1: THREE.Mesh[] = []\n  const particles2: THREE.Mesh[] = []\n\n  for (let i = 0; i < 20; i++) {\n    const mesh = new THREE.Mesh(particleGeom, bonusMatRef.current)\n    mesh.scale.set(0, 0, 0)\n    particles1.push(addToScene(mesh))\n  }\n\n  for (let i = 0; i < 5; i++) {\n    const mesh = new THREE.Mesh(particleGeom, primMatRef.current)\n    mesh.scale.set(0, 0, 0)\n    particles2.push(addToScene(mesh))\n  }\n\n  particlesRef.current = particles1\n  particles2Ref.current = particles2\n\n  addToScene(new THREE.AmbientLight(0xffffff))\n\n  const directionalLight = new THREE.DirectionalLight(0xffffff, 1)\n  directionalLight.position.set(1, 5, 1)\n  directionalLight.castShadow = true\n  directionalLight.shadow.mapSize.width = 512\n  directionalLight.shadow.mapSize.height = 512\n  directionalLight.shadow.camera.near = 0.5\n  directionalLight.shadow.camera.far = 12\n  directionalLight.shadow.camera.left = -12\n  directionalLight.shadow.camera.right = 12\n  directionalLight.shadow.camera.bottom = -12\n  directionalLight.shadow.camera.top = 12\n  directionalLight.shadow.radius = 3\n  directionalLight.shadow.blurSamples = 4\n  addToScene(directionalLight)\n\n  const floor = addToScene(\n    new Reflector(new THREE.PlaneGeometry(floorSizeRef.current, floorSizeRef.current), {\n      color: new THREE.Color(colors.floor),\n      textureWidth: 1024,\n      textureHeight: 1024,\n    }),\n  )\n  floor.rotation.x = -Math.PI / 2\n  floor.receiveShadow = true\n  floorRef.current = floor\n\n  const carrotMarker = addToScene(\n    new THREE.Mesh(\n      new THREE.RingGeometry(0.25, 0.35, 32),\n      new THREE.MeshBasicMaterial({\n        color: new THREE.Color(colors.carrotBody),\n        transparent: true,\n        opacity: 0.65,\n        side: THREE.DoubleSide,\n      }),\n    ),\n  )\n  carrotMarker.rotation.x = -Math.PI / 2\n  carrotMarker.position.y = CARROT_MARKER_Y_OFFSET\n  carrotMarker.visible = false\n  carrotMarkerRef.current = carrotMarker\n\n  const carrotMarkerDot = addToScene(\n    new THREE.Mesh(\n      new THREE.CircleGeometry(0.07, 24),\n      new THREE.MeshBasicMaterial({\n        color: new THREE.Color(colors.carrotLeaf),\n        side: THREE.DoubleSide,\n      }),\n    ),\n  )\n  carrotMarkerDot.rotation.x = -Math.PI / 2\n  carrotMarkerDot.position.y = CARROT_MARKER_Y_OFFSET + 0.005\n  carrotMarkerDot.visible = false\n  carrotMarkerDotRef.current = carrotMarkerDot\n\n  return {\n    floorSimMat,\n    lineMaterial,\n    lineGeometry,\n    particleGeom,\n  }\n}\n","import { useEffect, type Dispatch, type MutableRefObject, type SetStateAction } from \"react\"\nimport * as THREE from \"three\"\nimport { Reflector } from \"three/examples/jsm/objects/Reflector.js\"\nimport { BufferSim } from \"./bunnySceneMaterials\"\nimport {\n  createBunnySceneScaffold,\n  loadRabbitModelIntoScene,\n  type AddToScene,\n  type BunnyMaterialRefs,\n} from \"./bunnySceneSetup.helpers\"\nimport type { BunnySceneColors } from \"./bunnyScene.types\"\n\ninterface BunnySceneSetupOptions extends BunnyMaterialRefs {\n  scene: THREE.Scene\n  camera: THREE.Camera\n  gl: THREE.WebGLRenderer\n  colors: BunnySceneColors\n  setModelLoaded: Dispatch<SetStateAction<boolean>>\n  floorSizeRef: MutableRefObject<number>\n  rabbitRef: MutableRefObject<THREE.Group | null>\n  rabbitBodyRef: MutableRefObject<THREE.Object3D | null>\n  earLeftRef: MutableRefObject<THREE.Object3D | null>\n  earRightRef: MutableRefObject<THREE.Object3D | null>\n  carrotRef: MutableRefObject<THREE.Object3D | null>\n  carrotMarkerRef: MutableRefObject<THREE.Mesh | null>\n  carrotMarkerDotRef: MutableRefObject<THREE.Mesh | null>\n  floorRef: MutableRefObject<Reflector | null>\n  lineRef: MutableRefObject<THREE.Line | null>\n  bufferSimRef: MutableRefObject<BufferSim | null>\n  floorSimMatRef: MutableRefObject<THREE.ShaderMaterial | null>\n  particlesRef: MutableRefObject<THREE.Mesh[]>\n  particles2Ref: MutableRefObject<THREE.Mesh[]>\n}\n\nexport const useBunnySceneSetup = ({\n  scene,\n  camera,\n  gl,\n  colors,\n  setModelLoaded,\n  floorSizeRef,\n  rabbitRef,\n  rabbitBodyRef,\n  earLeftRef,\n  earRightRef,\n  carrotRef,\n  carrotMarkerRef,\n  carrotMarkerDotRef,\n  floorRef,\n  lineRef,\n  bufferSimRef,\n  floorSimMatRef,\n  particlesRef,\n  particles2Ref,\n  primMatRef,\n  secMatRef,\n  bonusMatRef,\n  leafMatRef,\n  outlineMatRef,\n}: BunnySceneSetupOptions) => {\n  useEffect(() => {\n    scene.fog = new THREE.Fog(new THREE.Color(colors.fog).getHex(), 13, 20)\n    camera.position.set(0, 4, 8)\n    camera.lookAt(0, 0, 0)\n\n    const createdObjects: THREE.Object3D[] = []\n    const disposedRef = { current: false }\n\n    const addToScene: AddToScene = (object) => {\n      scene.add(object)\n      createdObjects.push(object)\n      return object\n    }\n\n    const { floorSimMat, lineMaterial, lineGeometry, particleGeom } = createBunnySceneScaffold({\n      gl,\n      colors,\n      floorSizeRef,\n      lineRef,\n      floorRef,\n      carrotMarkerRef,\n      carrotMarkerDotRef,\n      bufferSimRef,\n      floorSimMatRef,\n      particlesRef,\n      particles2Ref,\n      primMatRef,\n      secMatRef,\n      bonusMatRef,\n      leafMatRef,\n      outlineMatRef,\n      addToScene,\n    })\n\n    loadRabbitModelIntoScene({\n      addToScene,\n      disposedRef,\n      setModelLoaded,\n      rabbitRef,\n      rabbitBodyRef,\n      earLeftRef,\n      earRightRef,\n      carrotRef,\n      primMatRef,\n      secMatRef,\n      bonusMatRef,\n      leafMatRef,\n      outlineMatRef,\n    })\n\n    return () => {\n      disposedRef.current = true\n      setModelLoaded(false)\n\n      createdObjects.forEach((object) => {\n        if (object.parent === scene) {\n          scene.remove(object)\n        }\n      })\n\n      lineGeometry.dispose()\n      lineMaterial.dispose()\n      particleGeom.dispose()\n      floorSimMat.dispose()\n      bufferSimRef.current?.dispose()\n\n      lineRef.current = null\n      floorRef.current = null\n      carrotMarkerRef.current = null\n      carrotMarkerDotRef.current = null\n      rabbitRef.current = null\n      rabbitBodyRef.current = null\n      earLeftRef.current = null\n      earRightRef.current = null\n      carrotRef.current = null\n      particlesRef.current = []\n      particles2Ref.current = []\n      floorSimMatRef.current = null\n      bufferSimRef.current = null\n    }\n  }, [\n    bonusMatRef,\n    bufferSimRef,\n    camera,\n    carrotMarkerDotRef,\n    carrotMarkerRef,\n    carrotRef,\n    colors,\n    earLeftRef,\n    earRightRef,\n    floorRef,\n    floorSimMatRef,\n    floorSizeRef,\n    gl,\n    leafMatRef,\n    lineRef,\n    outlineMatRef,\n    particles2Ref,\n    particlesRef,\n    primMatRef,\n    rabbitBodyRef,\n    rabbitRef,\n    scene,\n    secMatRef,\n    setModelLoaded,\n  ])\n}\n","import type React from \"react\"\nimport { useCallback, useEffect, useRef, useState } from \"react\"\nimport { useThree } from \"@react-three/fiber\"\nimport * as THREE from \"three\"\nimport { Reflector } from \"three/examples/jsm/objects/Reflector.js\"\nimport gsap from \"gsap\"\nimport { BufferSim, createOutlineMaterial } from \"./bunnySceneMaterials\"\nimport type { BunnySceneColors, BunnySceneProps } from \"./bunnyScene.types\"\nimport { useBunnyPointerInput } from \"./useBunnyPointerInput\"\nimport { useBunnyRuntimeLoop } from \"./useBunnyRuntimeLoop\"\nimport { useBunnySceneSetup } from \"./useBunnySceneSetup\"\n\nexport type { BunnySceneColors }\n\nconst HIGH_CARROT_HEIGHT_THRESHOLD = 0.85\nconst CARROT_MARKER_Y_OFFSET = 0.01\n\nconst BunnyScene: React.FC<BunnySceneProps> = ({ colors, onCarrotCollected, isMobile }) => {\n  const { scene, gl, camera } = useThree()\n  const [modelLoaded, setModelLoaded] = useState(false)\n  const [isJumping, setIsJumping] = useState(false)\n\n  const rabbitRef = useRef<THREE.Group | null>(null)\n  const rabbitBodyRef = useRef<THREE.Object3D | null>(null)\n  const earLeftRef = useRef<THREE.Object3D | null>(null)\n  const earRightRef = useRef<THREE.Object3D | null>(null)\n  const carrotRef = useRef<THREE.Object3D | null>(null)\n  const carrotMarkerRef = useRef<THREE.Mesh | null>(null)\n  const carrotMarkerDotRef = useRef<THREE.Mesh | null>(null)\n  const floorRef = useRef<Reflector | null>(null)\n  const lineRef = useRef<THREE.Line | null>(null)\n  const bufferSimRef = useRef<BufferSim | null>(null)\n  const floorSimMatRef = useRef<THREE.ShaderMaterial | null>(null)\n  const particlesRef = useRef<THREE.Mesh[]>([])\n  const particles2Ref = useRef<THREE.Mesh[]>([])\n\n  const heroSpeedRef = useRef(new THREE.Vector2(0, 0))\n  const heroOldRotRef = useRef(0)\n  const heroAngularSpeedRef = useRef(0)\n  const heroOldUVPosRef = useRef(new THREE.Vector2(0.5, 0.5))\n  const heroNewUVPosRef = useRef(new THREE.Vector2(0.5, 0.5))\n  const targetHeroUVPosRef = useRef(new THREE.Vector2(0.5, 0.5))\n  const targetHeroAbsPosRef = useRef(new THREE.Vector2(0, 0))\n  const jumpParamsRef = useRef({ jumpProgress: 0 })\n  const isExplodingRef = useRef(false)\n  const mouseRef = useRef(new THREE.Vector2())\n  const raycasterRef = useRef(new THREE.Raycaster())\n  const floorSizeRef = useRef(30)\n  const timeRef = useRef(0)\n\n  const primMatRef = useRef<THREE.MeshToonMaterial>(\n    new THREE.MeshToonMaterial({ color: new THREE.Color(colors.bunnyPrimary) }),\n  )\n  const secMatRef = useRef<THREE.MeshToonMaterial>(\n    new THREE.MeshToonMaterial({ color: new THREE.Color(colors.bunnySecondary) }),\n  )\n  const bonusMatRef = useRef<THREE.MeshToonMaterial>(\n    new THREE.MeshToonMaterial({ color: new THREE.Color(colors.carrotBody) }),\n  )\n  const leafMatRef = useRef<THREE.MeshToonMaterial>(\n    new THREE.MeshToonMaterial({ color: new THREE.Color(colors.carrotLeaf) }),\n  )\n  const outlineMatRef = useRef<THREE.ShaderMaterial>(createOutlineMaterial())\n\n  useEffect(() => {\n    primMatRef.current.color.set(colors.bunnyPrimary)\n    secMatRef.current.color.set(colors.bunnySecondary)\n    bonusMatRef.current.color.set(colors.carrotBody)\n    leafMatRef.current.color.set(colors.carrotLeaf)\n    outlineMatRef.current.uniforms.color.value = new THREE.Color(colors.outline)\n    scene.fog = new THREE.Fog(new THREE.Color(colors.fog).getHex(), 13, 20)\n\n    if (floorRef.current) {\n      const mat = floorRef.current.material as THREE.Material & {\n        color?: THREE.Color\n        uniforms?: Record<string, { value: THREE.Color }>\n      }\n      if (mat.color) {\n        mat.color.set(colors.floor)\n      } else if (mat.uniforms?.color) {\n        mat.uniforms.color.value.set(new THREE.Color(colors.floor))\n      }\n    }\n\n    if (carrotMarkerRef.current) {\n      const markerMat = carrotMarkerRef.current.material as THREE.MeshBasicMaterial\n      markerMat.color.set(colors.carrotBody)\n    }\n\n    if (carrotMarkerDotRef.current) {\n      const markerDotMat = carrotMarkerDotRef.current.material as THREE.MeshBasicMaterial\n      markerDotMat.color.set(colors.carrotLeaf)\n    }\n  }, [colors, scene])\n\n  useBunnySceneSetup({\n    scene,\n    camera,\n    gl,\n    colors,\n    setModelLoaded,\n    floorSizeRef,\n    rabbitRef,\n    rabbitBodyRef,\n    earLeftRef,\n    earRightRef,\n    carrotRef,\n    carrotMarkerRef,\n    carrotMarkerDotRef,\n    floorRef,\n    lineRef,\n    bufferSimRef,\n    floorSimMatRef,\n    particlesRef,\n    particles2Ref,\n    primMatRef,\n    secMatRef,\n    bonusMatRef,\n    leafMatRef,\n    outlineMatRef,\n  })\n\n  const hideCarrotMarker = useCallback(() => {\n    if (carrotMarkerRef.current) carrotMarkerRef.current.visible = false\n    if (carrotMarkerDotRef.current) carrotMarkerDotRef.current.visible = false\n  }, [])\n\n  const spawnCarrot = useCallback(() => {\n    if (!carrotRef.current) return\n\n    hideCarrotMarker()\n\n    const spawnRange = isMobile ? 0.24 : 0.3\n    const px = (Math.random() - 0.5) * spawnRange\n    const py = (Math.random() - 0.5) * spawnRange\n    const h = 0.2 + Math.random() * 1\n    const spawnX = px * floorSizeRef.current\n    const spawnZ = py * floorSizeRef.current\n\n    carrotRef.current.position.x = spawnX\n    carrotRef.current.position.z = spawnZ\n    carrotRef.current.position.y = -1\n\n    carrotRef.current.scale.set(0, 0, 0)\n    carrotRef.current.visible = true\n\n    if (h > HIGH_CARROT_HEIGHT_THRESHOLD && carrotMarkerRef.current && carrotMarkerDotRef.current) {\n      carrotMarkerRef.current.visible = true\n      carrotMarkerDotRef.current.visible = true\n      carrotMarkerRef.current.position.set(spawnX, CARROT_MARKER_Y_OFFSET, spawnZ)\n      carrotMarkerDotRef.current.position.set(spawnX, CARROT_MARKER_Y_OFFSET + 0.005, spawnZ)\n      carrotMarkerRef.current.scale.set(0.4, 0.4, 0.4)\n      carrotMarkerDotRef.current.scale.set(0, 0, 0)\n\n      gsap.to(carrotMarkerRef.current.scale, {\n        duration: 0.8,\n        ease: \"elastic.out\",\n        x: 1,\n        y: 1,\n        z: 1,\n      })\n\n      gsap.to(carrotMarkerDotRef.current.scale, {\n        duration: 0.6,\n        ease: \"back.out(1.7)\",\n        x: 1,\n        y: 1,\n        z: 1,\n      })\n    }\n\n    gsap.to(carrotRef.current.scale, {\n      duration: 1.5,\n      ease: \"elastic.out\",\n      x: 1,\n      y: 1,\n      z: 1,\n    })\n\n    gsap.to(carrotRef.current.position, {\n      duration: 1.5,\n      ease: \"elastic.out\",\n      y: h,\n    })\n  }, [hideCarrotMarker, isMobile])\n\n  const explode = useCallback(\n    (pos: THREE.Vector3) => {\n      isExplodingRef.current = true\n\n      for (const mesh of particlesRef.current) {\n        mesh.position.set(pos.x, pos.y, pos.z)\n        mesh.scale.set(2, 2, 2)\n\n        gsap.to(mesh.position, {\n          x: pos.x + (-0.5 + Math.random()) * 1.5,\n          y: pos.y + (0.5 + Math.random()) * 1.5,\n          z: pos.z + (-0.5 + Math.random()) * 1.5,\n          duration: 1,\n          ease: \"power4.out\",\n        })\n\n        gsap.to(mesh.scale, {\n          x: 0,\n          y: 0,\n          z: 0,\n          duration: 1,\n          ease: \"power4.out\",\n          onComplete: () => {\n            spawnCarrot()\n            isExplodingRef.current = false\n          },\n        })\n      }\n\n      for (const mesh of particles2Ref.current) {\n        mesh.position.set(pos.x, pos.y, pos.z)\n        mesh.scale.set(2, 2, 2)\n\n        gsap.to(mesh.position, {\n          x: pos.x + (-0.5 + Math.random()) * 1.5,\n          y: pos.y + (0.5 + Math.random()) * 1.5,\n          z: pos.z + (-0.5 + Math.random()) * 1.5,\n          duration: 1,\n          ease: \"power4.out\",\n        })\n\n        gsap.to(mesh.scale, {\n          x: 0,\n          y: 0,\n          z: 0,\n          duration: 1,\n          ease: \"power4.out\",\n        })\n      }\n    },\n    [spawnCarrot],\n  )\n\n  const testCollision = useCallback(() => {\n    if (isExplodingRef.current || !rabbitRef.current || !carrotRef.current) return\n\n    const distVec = rabbitRef.current.position.clone()\n    distVec.sub(carrotRef.current.position)\n\n    if (distVec.length() <= 1 && carrotRef.current.visible) {\n      carrotRef.current.visible = false\n      hideCarrotMarker()\n      explode(carrotRef.current.position.clone())\n      onCarrotCollected()\n    }\n  }, [explode, hideCarrotMarker, onCarrotCollected])\n\n  const jump = useCallback(() => {\n    if (\n      !rabbitRef.current ||\n      !rabbitBodyRef.current ||\n      !earLeftRef.current ||\n      !earRightRef.current\n    ) {\n      return\n    }\n\n    setIsJumping(true)\n    const turns = Math.floor(heroSpeedRef.current.length() * 5) + 1\n    const jumpDuration = 0.5 + turns * 0.2\n    const targetRot = heroAngularSpeedRef.current > 0 ? Math.PI * 2 * turns : -Math.PI * 2 * turns\n\n    gsap.to(rabbitBodyRef.current.rotation, {\n      duration: jumpDuration,\n      ease: \"linear.none\",\n      y: targetRot,\n      onComplete: () => {\n        if (rabbitBodyRef.current) rabbitBodyRef.current.rotation.y = 0\n      },\n    })\n\n    gsap.to([earLeftRef.current.rotation, earRightRef.current.rotation], {\n      duration: jumpDuration * 0.8,\n      ease: \"power4.out\",\n      x: Math.PI / 4,\n    })\n\n    gsap.to([earLeftRef.current.rotation, earRightRef.current.rotation], {\n      duration: jumpDuration * 0.2,\n      delay: jumpDuration * 0.8,\n      ease: \"power4.in\",\n      x: 0,\n    })\n\n    gsap.to(jumpParamsRef.current, {\n      duration: jumpDuration * 0.5,\n      ease: \"power2.out\",\n      jumpProgress: 0.5,\n      onUpdate: () => {\n        if (!rabbitRef.current) return\n        const sin = Math.sin(jumpParamsRef.current.jumpProgress * Math.PI)\n        rabbitRef.current.position.y = Math.pow(sin, 4) * turns\n      },\n    })\n\n    gsap.to(jumpParamsRef.current, {\n      duration: jumpDuration * 0.5,\n      ease: \"power2.in\",\n      delay: jumpDuration * 0.5,\n      jumpProgress: 1,\n      onUpdate: () => {\n        if (!rabbitRef.current) return\n        const sin = Math.sin(jumpParamsRef.current.jumpProgress * Math.PI)\n        rabbitRef.current.position.y = Math.pow(sin, 1) * turns\n      },\n      onComplete: () => {\n        if (!rabbitRef.current) return\n        rabbitRef.current.position.y = 0\n        jumpParamsRef.current.jumpProgress = 0\n        setIsJumping(false)\n      },\n    })\n  }, [])\n\n  useBunnyPointerInput({\n    mouseRef,\n    rabbitRef,\n    isJumping,\n    onJump: jump,\n  })\n\n  useBunnyRuntimeLoop({\n    modelLoaded,\n    isMobile,\n    isJumping,\n    camera,\n    timeRef,\n    outlineMatRef,\n    rabbitRef,\n    earLeftRef,\n    earRightRef,\n    carrotRef,\n    floorRef,\n    lineRef,\n    floorSimMatRef,\n    bufferSimRef,\n    floorSizeRef,\n    mouseRef,\n    raycasterRef,\n    heroSpeedRef,\n    heroOldRotRef,\n    heroAngularSpeedRef,\n    heroOldUVPosRef,\n    heroNewUVPosRef,\n    targetHeroUVPosRef,\n    targetHeroAbsPosRef,\n    onCollisionCheck: testCollision,\n  })\n\n  return null\n}\n\nexport default BunnyScene\n","import { useCallback, useEffect, useRef, useState } from \"react\"\n\nconst CARROT_COUNT_STORAGE_KEY = \"bunny-carrot-count\"\n\nconst parseStoredCarrotCount = (value: string | null) => {\n  if (value === null) return 0\n  const parsed = parseInt(value, 10)\n  if (Number.isNaN(parsed) || parsed < 0) return 0\n  return parsed\n}\n\nconst useCarrotStorage = () => {\n  const [carrotCount, setCarrotCount] = useState(() => {\n    if (typeof window === \"undefined\") return 0\n    return parseStoredCarrotCount(window.sessionStorage.getItem(CARROT_COUNT_STORAGE_KEY))\n  })\n  const skipNextWriteRef = useRef(false)\n\n  useEffect(() => {\n    if (typeof window === \"undefined\") return\n\n    const handleStorage = (event: StorageEvent) => {\n      if (event.key !== CARROT_COUNT_STORAGE_KEY) return\n      const next = parseStoredCarrotCount(event.newValue)\n\n      setCarrotCount((prev) => {\n        if (prev === next) return prev\n        skipNextWriteRef.current = true\n        return next\n      })\n    }\n\n    window.addEventListener(\"storage\", handleStorage)\n    return () => window.removeEventListener(\"storage\", handleStorage)\n  }, [])\n\n  useEffect(() => {\n    if (typeof window === \"undefined\") return\n\n    if (skipNextWriteRef.current) {\n      skipNextWriteRef.current = false\n      return\n    }\n\n    window.sessionStorage.setItem(CARROT_COUNT_STORAGE_KEY, carrotCount.toString())\n  }, [carrotCount])\n\n  const incrementCarrotCount = useCallback(() => {\n    setCarrotCount((prev) => prev + 1)\n  }, [])\n\n  return {\n    carrotCount,\n    incrementCarrotCount,\n  }\n}\n\nexport default useCarrotStorage\n","import type React from \"react\"\nimport { useEffect, useMemo, useRef, useState } from \"react\"\nimport { createPortal } from \"react-dom\"\nimport { Canvas } from \"@react-three/fiber\"\nimport \"./BunnyModal.css\"\nimport { BUNNY_MODAL_THEME_TOKENS, type ThemeType } from \"../../theme/tokens\"\nimport useIsMobile from \"../../hooks/useIsMobile\"\nimport BunnyScene, { type BunnySceneColors } from \"./BunnyScene\"\nimport useCarrotStorage from \"./useCarrotStorage\"\n\ninterface BunnyModalProps {\n  onClose: () => void\n  theme: ThemeType\n}\n\nconst MODAL_ROOT_ID = \"bunny-modal-root\"\n\nconst BunnyModal: React.FC<BunnyModalProps> = ({ onClose, theme }) => {\n  const portalRef = useRef<HTMLDivElement | null>(null)\n  const [mounted, setMounted] = useState(false)\n  const isMobile = useIsMobile(768)\n  const { carrotCount, incrementCarrotCount } = useCarrotStorage()\n\n  useEffect(() => {\n    if (typeof document === \"undefined\") return\n\n    let host = document.getElementById(MODAL_ROOT_ID)\n    if (!host) {\n      host = document.createElement(\"div\")\n      host.id = MODAL_ROOT_ID\n      document.body.appendChild(host)\n    }\n\n    const container = document.createElement(\"div\")\n    host.appendChild(container)\n    portalRef.current = container\n    setMounted(true)\n\n    return () => {\n      if (portalRef.current && host?.contains(portalRef.current)) {\n        host.removeChild(portalRef.current)\n      }\n      if (host && host.childNodes.length === 0) {\n        host.remove()\n      }\n      portalRef.current = null\n    }\n  }, [])\n\n  const palette = BUNNY_MODAL_THEME_TOKENS[theme]\n  const sceneColors = useMemo<BunnySceneColors>(\n    () => ({\n      floor: palette[\"--game-floor\"],\n      fog: palette[\"--game-fog\"],\n      bunnyPrimary: palette[\"--bunny-primary\"],\n      bunnySecondary: palette[\"--bunny-secondary\"],\n      carrotBody: palette[\"--carrot-body\"],\n      carrotLeaf: palette[\"--carrot-leaf\"],\n      outline: palette[\"--game-outline\"],\n    }),\n    [palette],\n  )\n\n  if (!mounted || !portalRef.current) {\n    return null\n  }\n\n  return createPortal(\n    <div\n      className=\"bunny-modal-backdrop\"\n      style={{\n        [\"--bunny-modal-border\" as string]: palette[\"--game-border\"],\n        [\"--bunny-modal-shadow\" as string]: palette[\"--game-shadow\"],\n        [\"--bunny-modal-radius\" as string]: isMobile ? \"18px\" : \"26px\",\n        [\"--bunny-modal-text\" as string]: palette[\"--color-text\"],\n        [\"--bunny-modal-accent\" as string]: palette[\"--color-accent-primary\"],\n        [\"--bunny-modal-button-bg\" as string]: palette[\"--button-bg-light\"],\n        [\"--bunny-modal-counter-top\" as string]: isMobile ? \"16px\" : \"26px\",\n        [\"--bunny-modal-counter-left\" as string]: isMobile ? \"16px\" : \"30px\",\n        [\"--bunny-modal-counter-size\" as string]: isMobile ? \"0.65rem\" : \"0.8rem\",\n      }}\n      onClick={onClose}\n    >\n      <div className=\"bunny-modal-panel\" onClick={(e) => e.stopPropagation()}>\n        <Canvas\n          className=\"bunny-modal-canvas\"\n          shadows\n          gl={{\n            antialias: true,\n            preserveDrawingBuffer: true,\n            alpha: false,\n          }}\n          dpr={typeof window !== \"undefined\" ? window.devicePixelRatio : 1}\n        >\n          <BunnyScene\n            colors={sceneColors}\n            onCarrotCollected={incrementCarrotCount}\n            isMobile={isMobile}\n          />\n        </Canvas>\n\n        <div className=\"bunny-modal-counter\">CARROTS  {carrotCount}</div>\n\n        <div className=\"bunny-modal-hint\">- Press to jump -</div>\n\n        <div className=\"bunny-modal-footer\">\n          <button type=\"button\" className=\"bunny-modal-text-button\" onClick={onClose}>\n            close\n          </button>\n        </div>\n\n        <button type=\"button\" onClick={onClose} className=\"bunny-modal-close-button\">\n          \n        </button>\n      </div>\n    </div>,\n    portalRef.current,\n  )\n}\n\nexport default BunnyModal\n"],"names":["BufferSim","constructor","renderer","width","height","shader","orthoScene","fbos","current","output","orthoCamera","orthoQuad","this","THREE","fbo","wrapS","wrapT","minFilter","magFilter","format","type","stencilBuffer","depthBuffer","texture","generateMipmaps","clone","add","render","uniforms","inputTexture","value","setRenderTarget","dispose","geometry","forEach","getShortestAngle","v","a","Math","PI","constrain","vMin","vMax","min","max","createBunnySceneScaffold","_ref3","gl","colors","floorSizeRef","lineRef","floorRef","carrotMarkerRef","carrotMarkerDotRef","bufferSimRef","floorSimMatRef","particlesRef","particles2Ref","primMatRef","bonusMatRef","addToScene","floorSimMat","time","blade1PosOld","blade1PosNew","strength","vertexShader","fragmentShader","lineMaterial","color","linewidth","scale","dashSize","gapSize","lineGeometry","setFromPoints","line","particleGeom","particles1","particles2","i","mesh","set","push","directionalLight","position","castShadow","shadow","mapSize","camera","near","far","left","right","bottom","top","radius","blurSamples","floor","Reflector","textureWidth","textureHeight","rotation","x","receiveShadow","carrotMarker","carrotBody","transparent","opacity","side","y","visible","carrotMarkerDot","carrotLeaf","CARROT_MARKER_Y_OFFSET","useBunnySceneSetup","_ref","scene","setModelLoaded","rabbitRef","rabbitBodyRef","earLeftRef","earRightRef","carrotRef","secMatRef","leafMatRef","outlineMatRef","useEffect","fog","getHex","lookAt","createdObjects","disposedRef","object","_ref2","materialRefs","GLTFLoader","load","gltf","model","rabbit","getObjectByName","rabbitBody","earRight","earLeft","tail","footLeft","footRight","eyeLeft","eyeRight","carrot","carrotLeaf2","applyRabbitMaterialsAndOutlines","parts","z","material","addOutline","obj","outline","children","traverse","isMesh","loadRabbitModelIntoScene","_bufferSimRef$current","parent","remove","onCarrotCollected","isMobile","useThree","modelLoaded","useState","isJumping","setIsJumping","useRef","heroSpeedRef","heroOldRotRef","heroAngularSpeedRef","heroOldUVPosRef","heroNewUVPosRef","targetHeroUVPosRef","targetHeroAbsPosRef","jumpParamsRef","jumpProgress","isExplodingRef","mouseRef","raycasterRef","timeRef","bunnyPrimary","bunnySecondary","size","_mat$uniforms","mat","hideCarrotMarker","useCallback","spawnCarrot","spawnRange","px","random","py","h","spawnX","spawnZ","gsap","to","duration","ease","explode","pos","onComplete","testCollision","distVec","sub","length","jump","turns","jumpDuration","targetRot","delay","onUpdate","sin","pow","onJump","handleMouseMove","event","clientX","window","innerWidth","clientY","innerHeight","handleTouchMove","touches","preventDefault","handlePress","addEventListener","passive","removeEventListener","useBunnyPointerInput","onCollisionCheck","useFrame","_","delta","dt","setFromCamera","intersects","intersectObject","uv","clampRange","constrainUVPosX","constrainUVPosY","dx","dy","angle","atan2","heroDistance","sqrt","ax","ay","linePositions","attributes","array","needsUpdate","computeLineDistances","tScratches","copy","useBunnyRuntimeLoop","CARROT_COUNT_STORAGE_KEY","parseStoredCarrotCount","parsed","parseInt","Number","isNaN","useCarrotStorage","carrotCount","setCarrotCount","sessionStorage","getItem","skipNextWriteRef","handleStorage","key","next","newValue","prev","setItem","toString","incrementCarrotCount","MODAL_ROOT_ID","onClose","theme","portalRef","mounted","setMounted","useIsMobile","document","host","getElementById","createElement","id","body","appendChild","container","_host","contains","removeChild","childNodes","palette","BUNNY_MODAL_THEME_TOKENS","sceneColors","useMemo","createPortal","_jsx","className","style","onClick","_jsxs","e","stopPropagation","Canvas","shadows","antialias","preserveDrawingBuffer","alpha","dpr","devicePixelRatio","BunnyScene"],"sourceRoot":""}