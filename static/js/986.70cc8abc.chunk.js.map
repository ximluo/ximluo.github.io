{"version":3,"file":"static/js/986.70cc8abc.chunk.js","mappings":"wwiBAkCA,MAAMA,EAAgBC,EAuBtB,MAkDA,EAlDsDC,IAW/C,IAADC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,IAXiD,IACrDC,EAAG,IACHC,EAAG,SACHC,GAAW,EAAK,mBAChBC,GAAqB,EAAK,MAC1BC,EAAK,MACLC,EAAK,OACLC,EAAM,SACNC,EAAQ,cACRC,KACGC,GACJf,EACC,MAAMgB,EAjCR,SAA6BC,GAC3B,MAAMC,EAAOD,EAAOE,MAAM,KAAK,GAAGA,MAAM,KAAK,GAE7C,GAAID,EAAKE,WAAW,YAAcF,EAAKE,WAAW,YAChD,IAEE,OADY,IAAIC,IAAIH,GACTI,UAAYJ,CACzB,CAAE,MACA,OAAOA,CACT,CASF,OAAOA,EAAKE,WAAW,KAAOF,EAAO,IAAIA,GAC3C,CAc2BK,CAAoBjB,GACvCkB,EAAcR,EAAiBS,cAAcC,SAAS,QAEtDC,GAAYC,EAAAA,EAAAA,UAAQ,KACxB,MAAMC,EAAQ/B,EAAcgC,OAAOd,GACnC,IAAKa,EAAO,OAAO,KACnB,MAAME,EAAeF,EAAMG,SACxBC,QAAQC,GAA6B,eAAjBA,EAAQC,OAC5BC,MAAK,CAACC,EAAGC,IAAMD,EAAEE,EAAID,EAAEC,IAC1B,MAAO,CACLV,QACAW,OAAQT,EAAaU,OACjBV,EAAaW,KAAKR,GAAY,GAAGA,EAAQ5B,OAAO4B,EAAQK,OAAMI,KAAK,WACnEC,EACL,GACA,CAAC5B,IAEE6B,EAAkBC,QAAQrC,GAAsBe,IAAwB,OAATG,QAAS,IAATA,GAAuB,QAAd1B,EAAT0B,EAAWE,MAAMkB,cAAM,IAAA9C,OAAd,EAATA,EAAyBK,MACxF0C,EAAcH,GAA8C,QAA/B3C,EAAY,OAATyB,QAAS,IAATA,GAAuB,QAAdxB,EAATwB,EAAWE,MAAMkB,cAAM,IAAA5C,OAAd,EAATA,EAAyBG,WAAG,IAAAJ,EAAAA,EAAUI,EACtE2C,EAAiBJ,GAAuC,OAATlB,QAAS,IAATA,OAAZiB,EAAYjB,EAAWa,OAC1DU,EAAgBL,OAAkBD,EAAiB,OAALlC,QAAK,IAALA,EAAAA,EAAUuC,EAAiB,aAAUL,EAEzF,OACEO,EAAAA,EAAAA,KAAA,UACMpC,EACJT,IAAK0C,EACLzC,IAAKA,EACLiC,OAAQS,EACRvC,MAAOwC,EACPvC,MAAY,OAALA,QAAK,IAALA,EAAAA,EAAgC,QAA3BP,EAAc,OAATuB,QAAS,IAATA,OAAS,EAATA,EAAWE,MAAMlB,aAAK,IAAAP,EAAAA,OAAIwC,EAC3ChC,OAAc,OAANA,QAAM,IAANA,EAAAA,EAAkC,QAA5BP,EAAc,OAATsB,QAAS,IAATA,OAAS,EAATA,EAAWE,MAAMjB,cAAM,IAAAP,EAAAA,OAAIuC,EAC9CQ,QAAS5C,EAAW,QAAU,OAC9BK,SAAkB,OAARA,QAAQ,IAARA,EAAAA,EAAY,QACtBC,cAA4B,OAAbA,QAAa,IAAbA,EAAAA,EAAkBN,EAAW,OAAS,QACrD,C","sources":["components/ui/OptimizedImage.tsx"],"sourcesContent":["import React, { useMemo } from \"react\"\nimport manifest from \"../../generated/imageManifest.json\"\n\ninterface ImageVariant {\n  src: string\n  w: number\n  type: string\n}\n\ninterface ManifestEntry {\n  width: number | null\n  height: number | null\n  variants: ImageVariant[]\n  poster?: {\n    src: string\n    w: number\n    type: string\n  } | null\n}\n\ninterface ImageManifest {\n  generatedAt: string\n  widths: number[]\n  images: Record<string, ManifestEntry>\n}\n\ninterface OptimizedImageProps\n  extends Omit<React.ImgHTMLAttributes<HTMLImageElement>, \"src\" | \"alt\" | \"loading\"> {\n  src: string\n  alt: string\n  priority?: boolean\n  preferPosterForGif?: boolean\n}\n\nconst imageManifest = manifest as ImageManifest\n\nfunction normalizeSourcePath(source: string): string {\n  const base = source.split(\"#\")[0].split(\"?\")[0]\n\n  if (base.startsWith(\"http://\") || base.startsWith(\"https://\")) {\n    try {\n      const url = new URL(base)\n      return url.pathname || base\n    } catch {\n      return base\n    }\n  }\n\n  const publicPrefix = process.env.PUBLIC_URL || \"\"\n  if (publicPrefix && base.startsWith(publicPrefix)) {\n    const stripped = base.slice(publicPrefix.length)\n    return stripped.startsWith(\"/\") ? stripped : `/${stripped}`\n  }\n\n  return base.startsWith(\"/\") ? base : `/${base}`\n}\n\nconst OptimizedImage: React.FC<OptimizedImageProps> = ({\n  src,\n  alt,\n  priority = false,\n  preferPosterForGif = false,\n  sizes,\n  width,\n  height,\n  decoding,\n  fetchPriority,\n  ...imgProps\n}) => {\n  const normalizedSource = normalizeSourcePath(src)\n  const isGifSource = normalizedSource.toLowerCase().endsWith(\".gif\")\n\n  const optimized = useMemo(() => {\n    const entry = imageManifest.images[normalizedSource]\n    if (!entry) return null\n    const webpVariants = entry.variants\n      .filter((variant) => variant.type === \"image/webp\")\n      .sort((a, b) => a.w - b.w)\n    return {\n      entry,\n      srcSet: webpVariants.length\n        ? webpVariants.map((variant) => `${variant.src} ${variant.w}w`).join(\", \")\n        : undefined,\n    }\n  }, [normalizedSource])\n\n  const shouldUsePoster = Boolean(preferPosterForGif && isGifSource && optimized?.entry.poster?.src)\n  const resolvedSrc = shouldUsePoster ? optimized?.entry.poster?.src ?? src : src\n  const resolvedSrcSet = shouldUsePoster ? undefined : optimized?.srcSet\n  const resolvedSizes = shouldUsePoster ? undefined : sizes ?? (resolvedSrcSet ? \"100vw\" : undefined)\n\n  return (\n    <img\n      {...imgProps}\n      src={resolvedSrc}\n      alt={alt}\n      srcSet={resolvedSrcSet}\n      sizes={resolvedSizes}\n      width={width ?? (optimized?.entry.width ?? undefined)}\n      height={height ?? (optimized?.entry.height ?? undefined)}\n      loading={priority ? \"eager\" : \"lazy\"}\n      decoding={decoding ?? \"async\"}\n      fetchPriority={fetchPriority ?? (priority ? \"high\" : \"auto\")}\n    />\n  )\n}\n\nexport default OptimizedImage\n"],"names":["imageManifest","manifest","_ref","_optimized$entry$post","_optimized$entry$post2","_optimized$entry$post3","_optimized$entry$widt","_optimized$entry$heig","src","alt","priority","preferPosterForGif","sizes","width","height","decoding","fetchPriority","imgProps","normalizedSource","source","base","split","startsWith","URL","pathname","normalizeSourcePath","isGifSource","toLowerCase","endsWith","optimized","useMemo","entry","images","webpVariants","variants","filter","variant","type","sort","a","b","w","srcSet","length","map","join","undefined","shouldUsePoster","Boolean","poster","resolvedSrc","resolvedSrcSet","resolvedSizes","_jsx","loading"],"sourceRoot":""}